<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>View Job Roles</title>
    <link rel="icon" href="https://kainos.com/favicon.png" type="image/x-icon">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Darker+Grotesque:wght@400;500&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css">
    </meta>
</head>

<body>
    <header class="p-4 bg-success">
        <div class="container">
            <div class="row">
                <div class="col-md-12">
                    <h1>
                        <img src="https://companieslogo.com/img/orig/KNOS.L_BIG-1e73b806.png?t=1652854256" alt="Kainos" class="img-fluid"
                            width="200" height="50">
                    </h1>
                </div>
            </div>
        </div>
    </header>
    <main class="container mt-4" style="font-family: 'Darker Grotesque'">
        {% if errormessage %} 
            <div id="view-job_roles-error" class="text-danger">{{ errormessage }}</div> 
        {% endif %}
        <section id="products" class="mt-4">
            <h2 id="jobs">Jobs</h2>
            {% if jobRoles and jobRoles.length > 0 %}
            <table class="table">
                <thead>
                    <tr>
                        <th scope="col" id="name">Name</th>
                        <th scope="col" id="specification">Specification</th>
                        <th scope="col" id="capability">Capability</th>
                        <th scope="col" id="bandLevel">Band Level</th>
                    </tr>
                </thead>
                <tbody>
                    {% for jobRole in jobRoles %}
                    <tr>             
                        <td><a href='/job_roles/{{ jobRole.id }}' id="specificationLink">{{ jobRole.name }}</a></td>
                        <td>{{ jobRole.specification }}</td>
                        <td>{{ jobRole.capability }}</td>
                        <td>{{ jobRole.bandLevel }}</td>
                        <td>
                            <button id="deleteButton" class="btn btn-danger" onclick="deleteJobRole('{{ jobRole.id }}')">Delete</button>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
            {% else %}
            There are no jobs.
            {% endif %}
        </section>
    </main>

    <footer class="p-3 bg-dark text-white text-right fixed-bottom small">
        <p>Copyright Â© 2023 Kainos.</p>
    </footer>
    <script>
        src="public/script.js"
        function deleteJobRole(jobRoleId) {
            if (confirm("Are you sure you want to delete this job role?")) {
                fetch(`/job_roles/${jobRoleId}`, {
                    method : "DELETE",
                })
                .then((response) => {
                    if (response.ok) {
                        location.reload();
                    } else {
                        throw new Error("Failed to delete job role");
                    }
                })
                .catch((error) => {
                    console.error(error);
                    alert("Failed to delete job role.");
                });
            }
        }
    </script>
</body>

</html>
</html>